# YesLocker - å°çƒæ†æŸœç®¡ç†å°ç¨‹åº

ä¸€ä¸ªç°ä»£åŒ–çš„å°çƒæ†æŸœæ•°å­—åŒ–ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒç”¨æˆ·ç«¯ç”³è¯·ã€ç®¡ç†ç«¯å®¡æ ¸ã€å­˜å–æ“ä½œè®°å½•ç­‰å®Œæ•´ä¸šåŠ¡æµç¨‹ã€‚

## é¡¹ç›®æ¦‚è¿°

- **é¡¹ç›®åç§°**: YesLocker - å°çƒæ†æŸœç®¡ç†å°ç¨‹åº
- **æŠ€æœ¯æ¶æ„**: uni-app (H5) + Supabase + Vercel + è…¾è®¯äº‘SMS
- **å¼€å‘æ¨¡å¼**: ä¸‰ç»ˆç«¯åä½œå¼€å‘
- **ç›®æ ‡ç”¨æˆ·**: å°çƒå…é¡¾å®¢ã€é—¨åº—ç®¡ç†å‘˜ã€æ€»éƒ¨ç®¡ç†å‘˜

## æŠ€æœ¯æ ˆ

### å‰ç«¯
- **æ¡†æ¶**: uni-app + Vue 3 + TypeScript
- **çŠ¶æ€ç®¡ç†**: Pinia
- **UIç»„ä»¶**: uni-ui + è‡ªå®šä¹‰ç»„ä»¶
- **æ ·å¼**: SCSS + å“åº”å¼è®¾è®¡
- **éƒ¨ç½²**: Vercel

### åç«¯
- **æ•°æ®åº“**: Supabase (PostgreSQL)
- **API**: Supabase Edge Functions
- **è®¤è¯**: Supabase Auth + JWT
- **æ–‡ä»¶å­˜å‚¨**: Supabase Storage
- **çŸ­ä¿¡æœåŠ¡**: è…¾è®¯äº‘SMS

## é¡¹ç›®ç»“æ„

```
yeslocker/
â”œâ”€â”€ src/                    # ç”¨æˆ·ç«¯æºç  (Terminal 1)
â”‚   â”œâ”€â”€ pages/             # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ stores/            # PiniaçŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ static/            # é™æ€èµ„æº
â”œâ”€â”€ admin/                  # ç®¡ç†ç«¯æºç  (Terminal 2)
â”‚   â”œâ”€â”€ pages/             # ç®¡ç†ç«¯é¡µé¢
â”‚   â”‚   â”œâ”€â”€ login/         # ç™»å½•é¡µé¢ âœ…
â”‚   â”‚   â”œâ”€â”€ dashboard/     # æ•°æ®é¢æ¿ âœ…
â”‚   â”‚   â”œâ”€â”€ applications/  # ç”³è¯·å®¡æ ¸ ğŸ”„
â”‚   â”‚   â”œâ”€â”€ users/         # ç”¨æˆ·ç®¡ç† ğŸ”„
â”‚   â”‚   â”œâ”€â”€ lockers/       # æ†æŸœç®¡ç† ğŸ”„
â”‚   â”‚   â””â”€â”€ statistics/    # æ•°æ®ç»Ÿè®¡ ğŸ”„
â”‚   â”œâ”€â”€ stores/            # çŠ¶æ€ç®¡ç† âœ…
â”‚   â”œâ”€â”€ services/          # APIæœåŠ¡å±‚ âœ…
â”‚   â””â”€â”€ styles/            # æ ·å¼ç³»ç»Ÿ âœ…
â”œâ”€â”€ supabase/              # åç«¯é…ç½® (Terminal 2)
â”‚   â”œâ”€â”€ config.toml        # Supabaseé…ç½® âœ…
â”‚   â”œâ”€â”€ migrations/        # æ•°æ®åº“è¿ç§»æ–‡ä»¶ âœ…
â”‚   â”‚   â”œâ”€â”€ 20240301000001_initial_schema.sql
â”‚   â”‚   â”œâ”€â”€ 20240301000002_sms_tables.sql
â”‚   â”‚   â”œâ”€â”€ 20240301000003_admin_logs.sql
â”‚   â”‚   â””â”€â”€ 20240301000004_approval_function.sql
â”‚   â””â”€â”€ functions/         # Edge Functions âœ…
â”‚       â”œâ”€â”€ auth-register/
â”‚       â”œâ”€â”€ auth-login/
â”‚       â”œâ”€â”€ admin-login/
â”‚       â”œâ”€â”€ sms-send/
â”‚       â”œâ”€â”€ lockers-apply/
â”‚       â”œâ”€â”€ stores-lockers/
â”‚       â”œâ”€â”€ locker-operations/
â”‚       â””â”€â”€ admin-approval/
â”œâ”€â”€ specs/                 # éœ€æ±‚æ–‡æ¡£
â”œâ”€â”€ DEVELOPMENT_PLAN.md    # å¼€å‘è®¡åˆ’ (å«Terminal 2è¿›åº¦)
â”œâ”€â”€ vercel.json            # éƒ¨ç½²é…ç½® âœ…
â””â”€â”€ README.md             # é¡¹ç›®è¯´æ˜ (æœ¬æ–‡æ¡£)
```

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 16
- npm >= 8
- Supabase CLI
- Vercel CLI (å¯é€‰)

### å®‰è£…ä¾èµ–

```bash
# å®‰è£…ä¸»é¡¹ç›®ä¾èµ–
npm install

# å®‰è£…ç®¡ç†ç«¯ä¾èµ–
cd admin && npm install
```

### ç¯å¢ƒé…ç½®

1. **Supabaseé…ç½®**
   ```bash
   # åˆå§‹åŒ–Supabaseé¡¹ç›®
   supabase init
   
   # å¯åŠ¨æœ¬åœ°å¼€å‘ç¯å¢ƒ
   supabase start
   
   # è¿è¡Œæ•°æ®åº“è¿ç§»
   supabase db push
   ```

2. **ç¯å¢ƒå˜é‡é…ç½®**
   
   åˆ›å»º `.env.local` æ–‡ä»¶ï¼š
   ```env
   SUPABASE_URL=your_supabase_url
   SUPABASE_ANON_KEY=your_supabase_anon_key
   SUPABASE_SERVICE_ROLE_KEY=your_service_role_key
   
   # è…¾è®¯äº‘SMSé…ç½®
   TENCENT_SECRET_ID=your_secret_id
   TENCENT_SECRET_KEY=your_secret_key
   TENCENT_SMS_APP_ID=your_app_id
   TENCENT_SMS_SIGN_NAME=your_sign_name
   ```

### æœ¬åœ°å¼€å‘

```bash
# å¯åŠ¨ç”¨æˆ·ç«¯å¼€å‘æœåŠ¡å™¨
npm run dev

# å¯åŠ¨ç®¡ç†ç«¯å¼€å‘æœåŠ¡å™¨
npm run dev:admin

# å¯åŠ¨Supabase Edge Functions
npm run functions:serve
```

## éƒ¨ç½²æŒ‡å—

### Verceléƒ¨ç½²

1. **è¿æ¥GitHubä»“åº“**
   ```bash
   vercel --prod
   ```

2. **é…ç½®ç¯å¢ƒå˜é‡**
   åœ¨Vercel Dashboardä¸­é…ç½®æ‰€æœ‰å¿…è¦çš„ç¯å¢ƒå˜é‡

3. **åŸŸåé…ç½®**
   - ç”¨æˆ·ç«¯: https://your-domain.com
   - ç®¡ç†ç«¯: https://your-domain.com/admin

### Supabaseéƒ¨ç½²

```bash
# éƒ¨ç½²Edge Functions
supabase functions deploy

# éƒ¨ç½²æ•°æ®åº“è¿ç§»
supabase db push --linked
```

## åŠŸèƒ½æ¨¡å—

### ç”¨æˆ·ç«¯åŠŸèƒ½ (Terminal 1)
- âœ… ç”¨æˆ·æ³¨å†Œç™»å½• (æ‰‹æœºå·+çŸ­ä¿¡éªŒè¯)
- âœ… æ†æŸœç”³è¯·æµç¨‹
- ğŸ”„ å­˜å–æ†æ“ä½œè®°å½• (è¿›è¡Œä¸­)
- ğŸ“‹ ç”µå­å‡­è¯å±•ç¤º (å¾…å¼€å‘)
- ğŸ“± å†å²è®°å½•æŸ¥è¯¢ (å¾…å¼€å‘)
- ğŸ”” é€šçŸ¥æ¶ˆæ¯ç³»ç»Ÿ (å¾…å¼€å‘)

### ç®¡ç†ç«¯åŠŸèƒ½ (Terminal 2)
- âœ… ç®¡ç†å‘˜ç™»å½•è®¤è¯
- âœ… æ•°æ®é¢æ¿ç»Ÿè®¡
- âœ… ç”³è¯·å®¡æ ¸ç®¡ç†
- âœ… æ†æŸœçŠ¶æ€ç®¡ç†
- âœ… ç”¨æˆ·ä¿¡æ¯ç®¡ç†
- âœ… æ“ä½œè®°å½•æŸ¥è¯¢
- ğŸ“Š æ•°æ®ç»Ÿè®¡å¯¼å‡º (éœ€è¡¥å……é¡µé¢)
- ğŸ”” æé†’ç®¡ç†åŠŸèƒ½ (éœ€è¡¥å……é¡µé¢)

### åç«¯API (Terminal 2)
- âœ… ç”¨æˆ·è®¤è¯API (`auth-register`, `auth-login`)
- âœ… ç®¡ç†å‘˜è®¤è¯API (`admin-login`)
- âœ… ä¸šåŠ¡æ ¸å¿ƒAPI (`lockers-apply`, `stores-lockers`, `locker-operations`)
- âœ… ç®¡ç†åŠŸèƒ½API (`admin-approval`)
- âœ… çŸ­ä¿¡æœåŠ¡API (`sms-send`)
- ğŸ”„ ç¬¬ä¸‰æ–¹é›†æˆ (è…¾è®¯äº‘SMSçœŸå®å¯¹æ¥)

## æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒæ•°æ®è¡¨
- `users` - ç”¨æˆ·ä¿¡æ¯è¡¨
- `stores` - é—¨åº—ä¿¡æ¯è¡¨
- `lockers` - æ†æŸœä¿¡æ¯è¡¨
- `locker_records` - æ“ä½œè®°å½•è¡¨
- `admins` - ç®¡ç†å‘˜è¡¨
- `applications` - ç”³è¯·è®°å½•è¡¨
- `reminders` - æé†’è®°å½•è¡¨

### æƒé™æ§åˆ¶
- é‡‡ç”¨Supabase RLS (Row Level Security)
- å¤šçº§æƒé™ï¼šè¶…çº§ç®¡ç†å‘˜ã€é—¨åº—ç®¡ç†å‘˜ã€æ™®é€šç”¨æˆ·
- JWTè®¤è¯ + è¡Œçº§æ•°æ®å®‰å…¨ç­–ç•¥

## APIæ–‡æ¡£

### è®¤è¯ç›¸å…³
- `POST /auth-register` - ç”¨æˆ·æ³¨å†Œ
- `POST /auth-login` - ç”¨æˆ·ç™»å½•
- `POST /admin-login` - ç®¡ç†å‘˜ç™»å½•
- `POST /sms-send` - å‘é€çŸ­ä¿¡éªŒè¯ç 

### ä¸šåŠ¡ç›¸å…³
- `POST /lockers-apply` - ç”³è¯·æ†æŸœ
- `GET /stores-lockers` - è·å–é—¨åº—å’Œæ†æŸœä¿¡æ¯
- `POST /locker-operations` - å­˜å–æ†æ“ä½œ
- `GET/POST /admin-approval` - ç®¡ç†å‘˜å®¡æ ¸

## å¼€å‘è¿›åº¦ (æ›´æ–°æ—¶é—´: 2024-08-02)

### Terminal 2 æœ€æ–°è¿›å±•

#### å·²å®Œæˆ âœ… (90%)
**åç«¯APIä½“ç³» (100%å®Œæˆ)**
- [x] å®Œæ•´çš„PostgreSQLæ•°æ®åº“æ¶æ„è®¾è®¡ (7ä¸ªæ ¸å¿ƒè¡¨)
- [x] RLS (Row Level Security) å®‰å…¨ç­–ç•¥é…ç½®
- [x] æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–å’Œæ€§èƒ½è°ƒä¼˜
- [x] 8ä¸ªæ ¸å¿ƒEdge Functions APIå®ç°
  - `auth-register` - ç”¨æˆ·æ³¨å†Œ âœ…
  - `auth-login` - ç”¨æˆ·ç™»å½• âœ…
  - `admin-login` - ç®¡ç†å‘˜ç™»å½• âœ…
  - `sms-send` - çŸ­ä¿¡å‘é€ âœ…
  - `lockers-apply` - æ†æŸœç”³è¯· âœ…
  - `stores-lockers` - é—¨åº—å’Œæ†æŸœç®¡ç† âœ…
  - `locker-operations` - å­˜å–æ†æ“ä½œ âœ…
  - `admin-approval` - ç®¡ç†å‘˜å®¡æ ¸ âœ…

**ç®¡ç†ç«¯å‰ç«¯æ¶æ„ (85%å®Œæˆ)**
- [x] uni-app + Vue 3 + TypeScriptæ¡†æ¶æ­å»º
- [x] PiniaçŠ¶æ€ç®¡ç†é…ç½®å®Œæˆ
- [x] è·¯ç”±ç»“æ„å’Œé¡µé¢æ¶æ„è®¾è®¡ (14ä¸ªæ ¸å¿ƒé¡µé¢)
- [x] ç®¡ç†å‘˜è®¤è¯ç³»ç»Ÿ (ç™»å½•é¡µé¢ã€çŠ¶æ€ç®¡ç†ã€æƒé™éªŒè¯)
- [x] æ•°æ®é¢æ¿é¡µé¢ (dashboardç»Ÿè®¡å±•ç¤º)
- [x] APIæœåŠ¡å±‚ (ç»Ÿä¸€è¯·æ±‚å°è£…ã€é”™è¯¯å¤„ç†)
- [x] å°çƒä¸»é¢˜UIæ ·å¼ç³»ç»Ÿ

**é¡¹ç›®åŸºç¡€è®¾æ–½ (100%å®Œæˆ)**
- [x] Supabaseé¡¹ç›®é…ç½® (config.toml)
- [x] æ•°æ®åº“è¿ç§»æ–‡ä»¶ (4ä¸ªè¿ç§»æ–‡ä»¶)
- [x] Verceléƒ¨ç½²é…ç½®
- [x] å¼€å‘æ–‡æ¡£å’ŒREADME

### Terminal 1 è¿›å±•
- [x] ç”¨æˆ·ç«¯åŸºç¡€æ¶æ„æ­å»º
- [x] ç”¨æˆ·æ³¨å†Œæµç¨‹å®ç°
- [x] ç™»å½•åŠŸèƒ½å¼€å‘
- [x] æ†æŸœç”³è¯·é¡µé¢
- [ ] å­˜å–æ†æ“ä½œåŠŸèƒ½
- [ ] ç”µå­å‡­è¯å±•ç¤º
- [ ] å†å²è®°å½•æŸ¥è¯¢

### è¿›è¡Œä¸­ ğŸ”„
- [ ] è…¾è®¯äº‘SMSçœŸå®é›†æˆ (Terminal 2) - å ä½ç¬¦å®ç°å·²å®Œæˆ
- [ ] ç®¡ç†ç«¯å‰©ä½™é¡µé¢å¼€å‘ (Terminal 2)
  - [ ] ç”³è¯·å®¡æ ¸é¡µé¢ (applications/index.vue)
  - [ ] ç”¨æˆ·ç®¡ç†é¡µé¢ (users/index.vue)
  - [ ] æ†æŸœç®¡ç†é¡µé¢ (lockers/index.vue)
  - [ ] æ•°æ®ç»Ÿè®¡é¡µé¢ (statistics/index.vue)
- [ ] ç”¨æˆ·ç«¯å®Œæ•´ä¸šåŠ¡æµç¨‹ (Terminal 1)
- [ ] æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½é›†æˆ

### å¾…å¼€å‘ ğŸ“‹
- [ ] ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å’Œé…ç½®
- [ ] é›†æˆæµ‹è¯•å’Œæ€§èƒ½ä¼˜åŒ–
- [ ] APIæ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ
- [ ] è¿ç»´ç›‘æ§ç³»ç»Ÿé…ç½®

## åä½œå¼€å‘

### ä¸‰ç»ˆç«¯åˆ†å·¥
- **Terminal 1**: å‰ç«¯ç”¨æˆ·ç«¯å¼€å‘
- **Terminal 2**: ç®¡ç†ç«¯+åç«¯å¼€å‘ (æœ¬ç»ˆç«¯)
- **Terminal 3**: ç´ ææ”¶é›†+UIè®¾è®¡

### ä»£ç ç®¡ç†
- ä½¿ç”¨Gitåˆ†æ”¯ç®¡ç†
- ä»£ç å®¡æŸ¥åˆ¶åº¦
- ç»Ÿä¸€ä»£ç è§„èŒƒ

## æµ‹è¯•è´¦å· (å¼€å‘ç¯å¢ƒ)

### ç®¡ç†å‘˜è´¦å·
- è¶…çº§ç®¡ç†å‘˜: `13800000001` / `admin123`
- é—¨åº—ç®¡ç†å‘˜: `13800000002` / `admin123`

### çŸ­ä¿¡éªŒè¯ç 
- å¼€å‘ç¯å¢ƒç»Ÿä¸€éªŒè¯ç : `123456`

## é¡¹ç›®é‡Œç¨‹ç¢‘

### Phase 1: åŸºç¡€æ¶æ„ âœ… (ç¬¬1-3å¤©)
- [x] é¡¹ç›®ç¯å¢ƒæ­å»º
- [x] æ•°æ®åº“è®¾è®¡å’Œå®ç°
- [x] åŸºç¡€APIå¼€å‘
- [x] è®¤è¯ç³»ç»Ÿå®ç°

### Phase 2: æ ¸å¿ƒåŠŸèƒ½ ğŸ”„ (ç¬¬4-12å¤©)
- [x] ç”¨æˆ·ç«¯æ³¨å†Œç™»å½• (Terminal 1)
- [x] æ†æŸœç”³è¯·API (Terminal 2)
- [x] ç®¡ç†ç«¯æ¡†æ¶æ­å»º (Terminal 2)
- [ ] å®Œæ•´ç”¨æˆ·ç«¯æµç¨‹ (Terminal 1)
- [ ] å®Œæ•´ç®¡ç†ç«¯é¡µé¢ (Terminal 2)

### Phase 3: é›†æˆä¼˜åŒ– ğŸ“‹ (ç¬¬13-17å¤©)
- [ ] ç¬¬ä¸‰æ–¹æœåŠ¡é›†æˆ
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] é›†æˆæµ‹è¯•
- [ ] å®‰å…¨å®¡è®¡

### Phase 4: éƒ¨ç½²ä¸Šçº¿ ğŸ“‹ (ç¬¬18-20å¤©)
- [ ] ç”Ÿäº§ç¯å¢ƒé…ç½®
- [ ] éƒ¨ç½²æµç¨‹
- [ ] è¿ç»´ç›‘æ§
- [ ] ç”¨æˆ·åŸ¹è®­æ–‡æ¡£

## æŠ€æœ¯äº®ç‚¹

1. **æ— æœåŠ¡å™¨æ¶æ„**: åŸºäºSupabase Edge Functionsï¼Œè‡ªåŠ¨æ‰©ç¼©å®¹
2. **è¡Œçº§å®‰å…¨**: PostgreSQL RLSç­–ç•¥ï¼Œæ•°æ®éš”ç¦»å®‰å…¨
3. **ç»Ÿä¸€æŠ€æœ¯æ ˆ**: uni-appå¤šç«¯å¤ç”¨ï¼Œé™ä½ç»´æŠ¤æˆæœ¬
4. **ç°ä»£åŒ–å¼€å‘**: TypeScript + Vue 3ç»„åˆå¼API
5. **å®Œæ•´çš„è®¤è¯ä½“ç³»**: JWT + å¤šçº§æƒé™ç®¡ç†

## è”ç³»æ–¹å¼

- **Terminal 2è´Ÿè´£äºº**: Full Stack Developer
- **é¡¹ç›®æ–‡æ¡£**: `/DEVELOPMENT_PLAN.md`
- **éœ€æ±‚æ–‡æ¡£**: `/specs/PRD.md`
- **æ›´æ–°æ—¶é—´**: 2024-08-02

## è®¸å¯è¯

MIT License

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªä¸‰ç»ˆç«¯åä½œå¼€å‘çš„é¡¹ç›®ï¼Œå½“å‰æ–‡æ¡£åæ˜ äº†æœ€æ–°çš„å¼€å‘è¿›åº¦ã€‚Terminal 2å·²å®Œæˆ90%çš„ä»»åŠ¡ï¼ŒåŒ…æ‹¬å®Œæ•´çš„åç«¯APIä½“ç³»å’Œç®¡ç†ç«¯åŸºç¡€æ¶æ„ã€‚