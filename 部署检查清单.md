# YesLocker 部署检查清单

## 一、部署前准备 🔧

### 1. 基础设施准备
- [ ] 云服务器已购买（推荐配置：2核4G以上）
- [ ] 域名已注册
- [ ] 域名已备案（国内服务器必须）
- [ ] SSL证书已准备（可使用Let's Encrypt免费证书）

### 2. 代码准备
- [ ] 所有代码已提交到Git仓库
- [ ] 创建了生产分支（production/main）
- [ ] 移除了所有console.log和调试代码
- [ ] 代码已通过ESLint检查
- [ ] 单元测试全部通过

### 3. 配置文件准备
- [ ] 服务器环境变量配置文件准备就绪
- [ ] 前端生产环境配置已更新
- [ ] 敏感信息已从代码中移除
- [ ] 所有API地址已更新为生产环境地址

### 4. 安全准备
- [ ] 生产环境JWT密钥已生成（强密码）
- [ ] 数据库密码已设置（如果使用数据库）
- [ ] API密钥已更新
- [ ] 测试账号已禁用或修改密码

## 二、服务器部署 🖥️

### 1. 服务器环境
- [ ] 操作系统更新到最新版本
- [ ] 防火墙已配置（只开放必要端口）
- [ ] SSH密钥已配置（禁用密码登录）
- [ ] 创建了非root用户用于部署

### 2. 软件安装
- [ ] Node.js 18.x 已安装
- [ ] PM2 已全局安装
- [ ] Nginx 已安装并启动
- [ ] Git 已安装

### 3. 目录结构
- [ ] /var/www/yeslocker 目录已创建
- [ ] /var/log/yeslocker 日志目录已创建
- [ ] /var/backups/yeslocker 备份目录已创建
- [ ] 目录权限已正确设置

## 三、后端API部署 🔌

### 1. 代码部署
- [ ] 代码已克隆到服务器
- [ ] npm install --production 已执行
- [ ] .env.production 配置文件已创建并配置

### 2. PM2配置
- [ ] ecosystem.config.js 已配置
- [ ] PM2启动成功
- [ ] PM2自启动已配置（pm2 startup）
- [ ] PM2进程已保存（pm2 save）

### 3. 功能测试
- [ ] API健康检查端点正常响应
- [ ] 数据持久化功能正常
- [ ] 日志记录正常

## 四、前端应用部署 🌐

### 1. 用户端部署
- [ ] 生产环境配置已更新
- [ ] npm run build 构建成功
- [ ] 静态文件已上传到服务器/CDN
- [ ] index.html 可正常访问

### 2. 管理端部署
- [ ] 生产环境配置已更新
- [ ] npm run build:admin 构建成功
- [ ] 静态文件已上传到服务器/CDN
- [ ] index.html 可正常访问

### 3. 静态资源优化
- [ ] Gzip压缩已启用
- [ ] 静态资源缓存策略已配置
- [ ] CDN已配置（可选）

## 五、Nginx配置 🔧

### 1. 配置文件
- [ ] api.yeslocker.com.conf 已配置
- [ ] www.yeslocker.com.conf 已配置
- [ ] admin.yeslocker.com.conf 已配置
- [ ] 配置语法检查通过（nginx -t）

### 2. SSL证书
- [ ] SSL证书已安装
- [ ] HTTPS重定向已配置
- [ ] SSL安全头部已添加
- [ ] SSL Labs测试评分A+

### 3. 安全配置
- [ ] 限流配置已启用
- [ ] 安全头部已配置
- [ ] 隐藏文件访问已禁止

## 六、域名配置 🌍

### 1. DNS设置
- [ ] A记录已配置指向服务器IP
- [ ] www子域名已配置
- [ ] admin子域名已配置
- [ ] api子域名已配置

### 2. SSL证书
- [ ] Let's Encrypt证书已申请
- [ ] 自动续期已配置
- [ ] 证书有效性已验证

## 七、安全检查 🔒

### 1. 服务器安全
- [ ] SSH端口已修改（非22端口）
- [ ] Fail2ban已安装配置
- [ ] 系统更新已设置自动安装
- [ ] 不必要的服务已关闭

### 2. 应用安全
- [ ] CORS已正确配置
- [ ] API限流已启用
- [ ] SQL注入防护已实施（如使用数据库）
- [ ] XSS防护已启用

### 3. 数据安全
- [ ] 自动备份已配置
- [ ] 备份恢复已测试
- [ ] 敏感数据加密存储
- [ ] 日志不包含敏感信息

## 八、监控配置 📊

### 1. 服务监控
- [ ] PM2监控已启用
- [ ] Nginx日志监控已配置
- [ ] 系统资源监控已设置
- [ ] 告警通知已配置

### 2. 应用监控
- [ ] API响应时间监控
- [ ] 错误日志监控
- [ ] 用户访问统计
- [ ] 性能指标收集

### 3. 日志管理
- [ ] 日志轮转已配置
- [ ] 日志备份策略已设置
- [ ] 日志分析工具已部署（可选）

## 九、功能验证 ✅

### 1. 用户端功能
- [ ] 用户注册登录正常
- [ ] 短信验证码发送正常
- [ ] 杆柜申请功能正常
- [ ] 个人中心功能正常

### 2. 管理端功能
- [ ] 管理员登录正常
- [ ] 申请审批功能正常
- [ ] 用户管理功能正常
- [ ] 数据统计功能正常

### 3. 系统集成
- [ ] 前后端通信正常
- [ ] 数据同步正常
- [ ] 文件上传功能正常
- [ ] 第三方服务集成正常

## 十、性能优化 🚀

### 1. 前端优化
- [ ] 代码分割已实施
- [ ] 图片懒加载已启用
- [ ] 资源预加载已配置
- [ ] Service Worker已部署（可选）

### 2. 后端优化
- [ ] API响应缓存已配置
- [ ] 数据库查询已优化（如使用数据库）
- [ ] 并发请求限制已设置
- [ ] 内存使用已优化

### 3. 网络优化
- [ ] HTTP/2已启用
- [ ] Keep-Alive已配置
- [ ] DNS预解析已添加
- [ ] 带宽优化已实施

## 十一、文档准备 📚

### 1. 技术文档
- [ ] API文档已更新
- [ ] 部署文档已完成
- [ ] 配置说明已编写
- [ ] 故障处理指南已准备

### 2. 运维文档
- [ ] 日常维护流程已编写
- [ ] 应急响应预案已制定
- [ ] 联系人列表已更新
- [ ] 服务依赖关系图已绘制

## 十二、上线准备 🎯

### 1. 最终检查
- [ ] 所有检查项已完成
- [ ] 团队成员已通知
- [ ] 回滚方案已准备
- [ ] 上线时间已确定

### 2. 上线执行
- [ ] 数据备份已完成
- [ ] 服务切换已执行
- [ ] DNS切换已完成
- [ ] 监控告警已关注

### 3. 上线验证
- [ ] 核心功能验证通过
- [ ] 性能指标正常
- [ ] 错误日志无异常
- [ ] 用户反馈渠道畅通

## 备注

- 完成时间：_____________________
- 负责人：_____________________
- 版本号：_____________________
- 特殊说明：_____________________

---

✅ 所有项目完成后，YesLocker系统即可正式上线运营！